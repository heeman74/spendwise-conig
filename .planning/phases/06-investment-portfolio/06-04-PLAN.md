---
phase: 06-investment-portfolio
plan: 04
type: execute
wave: 2
depends_on: ["06-02"]
files_modified:
  - spendwise/src/components/dashboard/PortfolioSummaryCard.tsx
  - spendwise/src/app/(dashboard)/dashboard/page.tsx
autonomous: true

must_haves:
  truths:
    - "Dashboard shows portfolio summary card with total portfolio value"
    - "Portfolio card shows total gain/loss amount and percentage with color coding"
    - "Portfolio card links to /investments for detailed view"
    - "Portfolio card handles empty state (no holdings) gracefully"
    - "Portfolio card handles loading and error states without breaking dashboard"
  artifacts:
    - path: "spendwise/src/components/dashboard/PortfolioSummaryCard.tsx"
      provides: "Self-contained dashboard widget showing portfolio value and gain/loss"
      contains: "usePortfolio"
    - path: "spendwise/src/app/(dashboard)/dashboard/page.tsx"
      provides: "Dashboard page with PortfolioSummaryCard integrated"
      contains: "PortfolioSummaryCard"
  key_links:
    - from: "spendwise/src/components/dashboard/PortfolioSummaryCard.tsx"
      to: "spendwise/src/hooks/usePortfolio.ts"
      via: "usePortfolio hook import"
      pattern: "usePortfolio"
    - from: "spendwise/src/app/(dashboard)/dashboard/page.tsx"
      to: "spendwise/src/components/dashboard/PortfolioSummaryCard.tsx"
      via: "component import"
      pattern: "PortfolioSummaryCard"
---

<objective>
Add a portfolio summary card to the dashboard, following the NetWorthSummaryCard pattern. Shows total portfolio value, gain/loss, and links to the investments page.

Purpose: Gives users a quick glance at their investment portfolio from the main dashboard, completing the Phase 6 feature set for the unified dashboard experience.
Output: PortfolioSummaryCard component integrated into the dashboard page.
</objective>

<execution_context>
@/Users/heechung/.claude/get-shit-done/workflows/execute-plan.md
@/Users/heechung/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-investment-portfolio/06-02-SUMMARY.md
@spendwise/src/components/dashboard/NetWorthSummaryCard.tsx
@spendwise/src/app/(dashboard)/dashboard/page.tsx
@spendwise/src/hooks/usePortfolio.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create PortfolioSummaryCard component</name>
  <files>spendwise/src/components/dashboard/PortfolioSummaryCard.tsx</files>
  <action>
**Create `spendwise/src/components/dashboard/PortfolioSummaryCard.tsx`** following the EXACT pattern from `NetWorthSummaryCard.tsx`:

```typescript
'use client';

import Link from 'next/link';
import { useSelector } from 'react-redux';
import Card from '@/components/ui/Card';
import Spinner from '@/components/ui/Spinner';
import { usePortfolio } from '@/hooks/usePortfolio';
import { formatCurrency, cn } from '@/lib/utils';
```

The card is a self-contained widget that fetches its own data (same pattern as NetWorthSummaryCard).

**Structure:**

1. **Hook:** `usePortfolio({ skip: isDemo })` — skip when in demo mode
2. **Gain calculation:** Use portfolio.totalGain and portfolio.totalGainPercent from the API
3. **States to handle:**
   - **Loading:** Show Card with Spinner (min-h-[200px])
   - **Error:** Show Card with title "Portfolio", value "--", "Unable to load portfolio" text, "View Details →" link
   - **Demo/empty (no portfolio or holdingCount === 0):** Show Card with title "Portfolio", value "$0.00", "No holdings yet" text, "View Details →" link
   - **Normal:** Full card with data

4. **Normal state layout:**
   - Wrap entire card in `<Link href="/investments">`
   - Card with `cursor-pointer hover:shadow-lg transition-shadow`
   - Header: "Portfolio" title on left, trend icon on right (stock chart icon, colored green/red based on gain)
   - Use this SVG for the icon: `<path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z" />`
   - Total value: `text-3xl font-bold` showing `formatCurrency(portfolio.totalValue)`
   - Gain/loss line: Arrow icon (up/down) + formatted gain amount + "total return" text
   - Color: green-600 for positive, red-600 for negative
   - Holding count: `X holdings across Y accounts` in small gray text
   - "View Details →" link in primary color at bottom

5. **Key differences from NetWorthSummaryCard:**
   - No sparkline (portfolio doesn't have time-series history in Phase 6)
   - Shows "total return" instead of "this month"
   - Shows holding count and account count
   - Uses stock chart icon instead of trend line icon
  </action>
  <verify>Run `cd /Users/heechung/projects/spendwise && npx tsc --noEmit` to check for TypeScript errors.</verify>
  <done>PortfolioSummaryCard is a self-contained dashboard widget showing portfolio value, gain/loss with color coding, holding/account counts, and linking to /investments.</done>
</task>

<task type="auto">
  <name>Task 2: Add PortfolioSummaryCard to dashboard page</name>
  <files>spendwise/src/app/(dashboard)/dashboard/page.tsx</files>
  <action>
**Edit `spendwise/src/app/(dashboard)/dashboard/page.tsx`:**

1. Add import: `import PortfolioSummaryCard from '@/components/dashboard/PortfolioSummaryCard';`

2. Add the PortfolioSummaryCard right after the existing NetWorthSummaryCard. Find this line:
   ```
   {/* Net Worth Summary */}
   <NetWorthSummaryCard />
   ```

   And add the portfolio card immediately after:
   ```tsx
   {/* Net Worth Summary */}
   <NetWorthSummaryCard />

   {/* Portfolio Summary */}
   <PortfolioSummaryCard />
   ```

This keeps the dashboard layout clean — both summary cards are full-width, stacked vertically between the stats grid and the charts grid. The PortfolioSummaryCard is self-contained and handles its own data fetching, loading, and error states.
  </action>
  <verify>
Run `cd /Users/heechung/projects/spendwise && npx tsc --noEmit` to check for TypeScript errors.
Run `cd /Users/heechung/projects/spendwise && npm run build` to confirm the build succeeds.
  </verify>
  <done>Dashboard page shows PortfolioSummaryCard after NetWorthSummaryCard. Both cards fetch their own data independently and handle errors gracefully without breaking the dashboard.</done>
</task>

</tasks>

<verification>
1. `cd /Users/heechung/projects/spendwise && npx tsc --noEmit` passes
2. `cd /Users/heechung/projects/spendwise && npm run build` succeeds
3. PortfolioSummaryCard.tsx fetches data via usePortfolio hook
4. Card shows portfolio value, gain/loss, holding count, account count
5. Card links to /investments
6. Card handles loading, error, empty, and demo states
7. Dashboard page renders PortfolioSummaryCard below NetWorthSummaryCard
</verification>

<success_criteria>
- PortfolioSummaryCard exists as self-contained component (fetches own data)
- Card displays total portfolio value with total gain/loss (colored)
- Card gracefully degrades on error (shows "--" not crash)
- Card links to /investments for full portfolio view
- Dashboard page includes PortfolioSummaryCard without breaking existing layout
- Build compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/06-investment-portfolio/06-04-SUMMARY.md`
</output>
